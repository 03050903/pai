
<table class="table">
  <tr>
    <th>Job Name</th>
    <th>User Name</th>
    <th>Start Time</th>
    <th>Application Start Time</th>
    <th>Application Finish Time</th>
    <th>Duration</th>
    <th>Retries</th>
    <th>Status</th>
  </tr>
  <tr>
    <td><%= jobName %></td>
    <td><%= jobStatus.username %></td>
    <td><%= convertTime(false, jobStatus.createdTime) %></td>
    <td><%= convertTime(false, jobStatus.appLaunchedTime) %></td>
    <td><%= convertTime(false, jobStatus.appCompletedTime) %></td>
    <td><%= convertTime(true, jobStatus.createdTime, jobStatus.completedTime) %></td>
    <td><%= jobStatus.retries %></td>
    <td><%= convertState(jobStatus.state) %></td>
  </tr>
</table>

<hr class="divider">

<b>&nbsp;Links:</b>
<a href="<%= jobStatus.appTrackingUrl %>" target="_blank">
  Yarn Log
</a>
&nbsp;|&nbsp;
<a href="<%= grafanaUri %>/dashboard/db/joblevelmetrics?var_job=<%= jobName %>" target="_blank">
  Job Metrics
</a>
&nbsp;|&nbsp;
<a data-toggle="collapse" href="#appExitDiagnostics" aria-expanded="false" aria-controls="appExitDiagnostics">
  Application Exit Diagnostics
</a>

<div class="collapse" id="appExitDiagnostics">
  <div class="well">
    <% if (jobStatus.appExitDiagnostics) { %>
      <%= jobStatus.appExitDiagnostics.replace(/\n/g, "<br>") %>
    <% } else { %>
      Not available yet.
    <% } %>
  </div>
</div>

<hr class="divider">

<table class="table">
  <thead>
    <tr>
      <th>Task Role</th>
      <th>Task Index</th>
      <th>Name of Container</th>
      <th>IP of Container</th>
      <th>GPU ID(s) in Container</th>
      <th>Links</th>
    </tr>
  </thead>
  <tbody>
    <% for (let taskRole of Object.keys(taskRoles)) { %>
      <% for (let i = 0; i < taskRoles[taskRole].taskStatuses.length; i ++) { %>
        <tr>
          <% if (i == 0) { %>
            <td rowspan="<%= taskRoles[taskRole].taskStatuses.length %>"><%= taskRole %></td>
          <% } %>
          <td><%= taskRoles[taskRole].taskStatuses[i].taskIndex %></td>
          <td><%= taskRoles[taskRole].taskStatuses[i].containerId %></td>
          <td><%= taskRoles[taskRole].taskStatuses[i].containerIp %></td>
          <td><%= convertGpu(taskRoles[taskRole].taskStatuses[i].containerGpus) %></td>
          <td>
            <div name='sshInfoDiv-<%= taskRoles[taskRole].taskStatuses[i].containerId %>' style='float:left'>
              <a name='sshInfoLink-<%= taskRoles[taskRole].taskStatuses[i].containerId %>'
                onclick='showSshInfo("<%= taskRoles[taskRole].taskStatuses[i].containerId %>")'
                href='javascript:void(0);'>SSH Info</a>
            </div>
            <div style='float:left'>&nbsp;|&nbsp;</div>
            <div style='float:left'>
              <a href="<%= taskRoles[taskRole].taskStatuses[i].containerLog %>" target="_blank">Log</a>
            </div>
          </td>
        </tr>
      <% } %>
    <% } %>
  </tbody>
</table>
